============================= test session starts ==============================
platform linux -- Python 3.10.16, pytest-8.4.0, pluggy-1.6.0
pytest-randomly: reseed with 1317154935
Using --randomly-seed=1317154935
rootdir: /home/girji/workspace/forks/hls4ml
configfile: pyproject.toml
plugins: randomly-3.16.0, cov-6.2.1, anyio-4.9.0
pytest-randomly: reseed with 1317154935
collected 2 items

test_keras_api.py F.                                                     [100%]

=================================== FAILURES ===================================
_________________________ test_dense[io_parallel-XLS] __________________________

backend = 'XLS', io_type = 'io_parallel'

    @pytest.mark.parametrize('backend', ['XLS'])
    @pytest.mark.parametrize('io_type', ['io_parallel'])
    def test_dense(backend, io_type):
        model = tf.keras.models.Sequential()
        model.add(
            Dense(
                2,
                input_shape=(2,),
                name='Dense',
                use_bias=True,
                kernel_initializer=tf.keras.initializers.RandomUniform(minval=1, maxval=10),
                bias_initializer='zeros',
                kernel_regularizer=None,
                bias_regularizer=None,
                activity_regularizer=None,
                kernel_constraint=None,
                bias_constraint=None,
            )
        )
        model.add(Activation(activation='relu', name='Activation'))
        model.compile(optimizer='adam', loss='mse')
    
        X_input = np.random.rand(100, 2)
    
        keras_prediction = model.predict(X_input)
    
        config = hls4ml.utils.config_from_keras_model(model)
        output_dir = str(test_root_path / f'hls4mlprj_keras_api_dense_{backend}_{io_type}')
    
        hls_model = hls4ml.converters.convert_from_keras_model(
            model, hls_config=config, output_dir=output_dir, backend=backend, io_type=io_type
        )
    
        hls_model.compile()
    
        hls_prediction = hls_model.predict(X_input)
    
        np.testing.assert_allclose(hls_prediction, keras_prediction, rtol=1e-2, atol=0.01)
    
        assert len(model.layers) + 1 == len(hls_model.get_layers())
>       assert list(hls_model.get_layers())[0].attributes['class_name'] == "InputLayer"
E       AssertionError: assert 'Input' == 'InputLayer'
E         
E         - InputLayer
E         + Input

test_keras_api.py:70: AssertionError
---------------------------- Captured stdout setup -----------------------------
pytest-randomly: reseed with 1317154934
----------------------------- Captured stdout call -----------------------------
pytest-randomly: reseed with 1317154935
1/4 [======>.......................] - ETA: 0s4/4 [==============================] - 0s 3ms/step
IN MATCH
IN TRUE MATCH
IN TRANSFORM
IN MATCH
IN MATCH
HERERE ===========
Node:  u32:1
HERERE ===========
Node:  u32:1
HERERE ===========
Node:  u32:1
--------------------------- Captured stdout teardown ---------------------------
pytest-randomly: reseed with 1317154936
=============================== warnings summary ===============================
../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:reshape_stream" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:process_fixed_point_quantizer_layer" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:clone_output" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:remove_final_reshape" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:register_bram_weights" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:xnor_pooling" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:generate_conv_im2col" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:skip_softmax" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:fix_softmax_table_size" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:inplace_parallel_reshape" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:inplace_stream_flatten" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

../../hls4ml/backends/xls/xls_backend.py:89
  /home/girji/workspace/forks/hls4ml/hls4ml/backends/xls/xls_backend.py:89: UserWarning: WARNING: Optimizer "xls:build_attr" is not part of any flow and will not be executed.
    warn(f'WARNING: Optimizer "{opt}" is not part of any flow and will not be executed.')

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED test_keras_api.py::test_dense[io_parallel-XLS] - AssertionError: asser...
=================== 1 failed, 1 passed, 12 warnings in 5.93s ===================
